```{r, code = readLines("common.R"), cache = FALSE, include=FALSE}
```

# Procedures



and functions




## Exercises {#ex-vba-procedures}

`r strExercises`

### Exercise - Subs {#ex-vba-subs}

The [file](https://github.com/bss-osca/tfa/blob/master/vba/vba-subs-template.xlsm) may be used as a starting point for this exercise. 

   (1) Create a sub `GetMsg` that takes a string and a Boolean as input and create a message box with the string content if the Boolean is true. Test the procedure using the `TestGetMsg` sub.
   (2) Modify the procedure so the Boolean have a default value equal to true.
   (3) Create a sub `PrintNameAge` that takes two arguments as input (name and age) and create a message box with the persons name and age.
   (4) Write a sub `TestPrintNameAge` that uses two input boxes to ask for name and age and then call sub `PrintNameAge`.

### Exercise - Functions {#ex-vba-functions}

The [file](https://github.com/bss-osca/tfa/blob/master/vba/vba-functions-template.xlsm) may be used as a starting point for this exercise. 

   (1) Write a function `Discount` which takes a two input arguments (doubles): the discount percentage and the amount and returns the discounted value. Have a look at the unfinished sub `Discount` for hints. Note the comments describing the function using the [coding convention](#coding-convention).
   (2) Write a function `Larger` which takes two integer arguments and returns true if the first is larger than the last; otherwise false.
   (3) Write a function `NumbDays` that takes a date as argument and return the number of days from today. Hint: Have a look at the `DateDiff` function. 
   
Test all the functions in the _Testing_ sheet.

   (4) Write a sub that uses an input box to ask for an amount a then returns the discounted amount when the discount is 20%. The sub should use the function in Question 1. Create a button running the sub. 

### Exercise - Worksheet functions {#ex-vba-worksheet-functions}

The [file](https://github.com/bss-osca/tfa/blob/master/vba/vba-worksheet-functions-template.xlsm) contains a procedure to generate a set of numbers.

Create a procedure `Summary` that uses worksheet functions to:

- Find the maximum number and write it to cell D1. 
- Find the minimum number and write it to cell D2. 
- Find the sum of the numbers and write it to cell D3. 
- Count the number of positives and write it to cell D4.
- Find the row number with maximum value and write it to cell D5. 

Google is a good place to start if you want to find a specific Excel function, e.g. try to search 'excel row with max value'.

### Exercise - `ByRef` {#ex-vba-byref}




```{r links, child="links.md", include=FALSE}
```