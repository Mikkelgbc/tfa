```{r, code = readLines("common.R"), cache = FALSE, include=FALSE}
```

# Object model {#mod-vba-object-model}


## Exercises {#ex-vba-object-model}

`r strExercises`

### Exercise - Worksheets {#ex-vba-worksheets}

The [file](https://github.com/bss-osca/tfa/blob/master/vba/vba-worksheets-template.xlsm) should be used as a starting point for this exercise.

Use the procedure `Main` to test the following questions.

   (1) Have a look at the function `WorksheetExists` and check if a worksheet named _Main_ exists.
   (2) Make a function `WorksheetCreate` that creates a worksheet given an input name (if does not exist in advance) and return true if created and false otherwise. Use the function to create a worksheet named _Testing_.
   (3) Make a function `WorksheetDelete` that deletes a worksheet given an input name (if it exists) and return true if deleted and false otherwise. Use the function to delete the worksheet named _Testing_.
   (4) Make a function `WorksheetRename` that renames a worksheet given input arguments name and a new name (if it exists) and return true if renamed and false otherwise. Use the function to create a worksheet named _Test_ and rename it to _Testing_.
   
You may use the functions in other exercises.


### Exercise - Ranges {#ex-vba-ranges}

The [file](https://github.com/bss-osca/tfa/blob/master/vba/vba-ranges-template.xlsm) should be used as a starting point for this exercise.

Consider the _Data_ worksheet. 

   (1) Have a look at the function `RngFormat` and try to test it in the `Main` procedure: Make range H1:I1 orange, Make range H2:I3 green and Auto fit range H1:I3.
   (2) Define `rng` as range B14:D17 and use a for each loop and `Debug.Print` to print out all its values in the Immediate window. Do the loop scan row wise or column wise?
   (3) Use the [`Count`](https://docs.microsoft.com/en-us/office/vba/api/excel.range.rows) property to count the number of row and columns in the range B14:D17.
   (4) Find the current region of A1 and F6.
   (5) Have a look at the function `GetCurRegionRows` and use it to find the number of rows of the current region of F6?
   (6) Create function `GetCurRegionCols` similar to `GetCurRegionRows` and use it to find the number of columns of the current region of B14?
   (7) Create a function `RngCopyInt` that takes a range with integer values and a dynamic array as arguments and copy the range into the array. Test in on range A1:B10 and use `Print2DArray` to print the array out in the range with upper left cell A26.
   (8) Have a look at the other range functions given. Find the last row of the current region with cell F19. Find the cell address of the lower left cell in the current region with cell D4. Why is it A22?

You may use the functions in other exercises.

### Exercise - Collections {#ex-vba-ranges}



```{r links, child="links.md", include=FALSE}
```