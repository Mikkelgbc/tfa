```{r, code = readLines("common.R"), cache = FALSE, include=FALSE}
```

# Loops and conditional statements {#mod-loops-cond}




## Exercises {#ex-vba-loops-cond}

`r strExercises`

### Exercise - Loops {#ex-vba-loops}

The [file](https://github.com/bss-osca/tfa/blob/master/vba/vba-loops-template.xlsm) may be used as a starting point for this exercise. Use the sheet _Testing_ for output.

   (1) Create a for loop that writes numbers 1 to 4 in rows 1 to 4 in column A.  
   (2) Create a while loop that writes numbers 1 to 4 in rows 1 to 4 in column B. 
   (3) Create a do while loop that writes numbers 1 to 4 in rows 1 to 4 in column C.
   (4) Create a loop that writes numbers 1 to 4 in rows 3 to 6 in column D.
   (5) Create a loop that writes numbers -1 to -4 in rows 1 to 4 in column E.
   (6) Create a loop that writes numbers 1 to 4 in rows 4 to 7 in column F, except if the number is 3 then the output should to a string `missing`.
   (7) Create a do while loop that writes numbers i = 1, 2, ... in column G until i/5 + 3 = 8. Hint: you may use a `Exit Do` to quit the loop. 
   (8) Create a sub `Main` that runs all the loops.

### Exercise - Flight search {#ex-vba-flight}

The [file](https://github.com/bss-osca/tfa/blob/master/vba/vba-flight-template.xlsm) should be used as a starting point for this exercise. 

The sheet _Data_ contains a set of fights between different destinations. You task is to create a program that can search for matching flights given a set of origins and destinations. 

   (1) Have a look at the results in sheet _Main_. The origin and destinations to search for are given in columns A and B and the search result in columns D, E and F. 
   (2) Try pressing the **Clear Search** button and see what happens. Have a look at the code in the VBA editor for this sub and get an overview. You are not expected to understand all the code.
   (3) Try to finish the first part of the `SearchFlights` sub and store the flights in arrays. Use the debugger to check if the values are stored correctly. 

```{r, hint=TRUE, eval=FALSE, title="Hint 2"}
 For o = 1 To intOrigins
     For i = 0 To intFlights - 1
         If Cells(5 + o, 1) = Origin(i) Then 
             For d = 1 To intDestinations
                 ___
             Next 
         End If
     Next 
 Next 
```
```{r, hint=TRUE, eval=FALSE, title="Hint 1", text="You need nested loops (loop over origins, flights, destinations)"}
```
   
   (4) Try to finish the second part of the `SearchFlights` sub and search for matching origin-destination pairs. Note origins and destinations listed to be searched for are also matching origin-destination pairs if they are not in the same row.

```{r links, child="links.md", include=FALSE}
```