<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 6 Generating random numbers | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 6 Generating random numbers | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 6 Generating random numbers | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2022-07-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="mod-vba-datatypes.html"/>
<link rel="next" href="groups.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<html>
<head>
<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lo-intro"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.2</b> Purpose for the course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-vs-vba"><i class="fa fa-check"></i><b>1.3</b> R vs Excel/VBA</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#computer"><i class="fa fa-check"></i><b>1.4</b> How a computer works</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.5</b> How the notes are organized</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#ex-intro"><i class="fa fa-check"></i><b>1.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#ex-annotate"><i class="fa fa-check"></i><b>1.7.1</b> Exercise - How to annotate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I VBA</b></span></li>
<li class="chapter" data-level="2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html"><i class="fa fa-check"></i><b>2</b> An introduction to VBA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#lo-vba-intro"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-what"><i class="fa fa-check"></i><b>2.2</b> What is VBA</a></li>
<li class="chapter" data-level="2.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-setup"><i class="fa fa-check"></i><b>2.3</b> Setup Excel for VBA</a></li>
<li class="chapter" data-level="2.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-hello"><i class="fa fa-check"></i><b>2.4</b> Your first program</a></li>
<li class="chapter" data-level="2.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-macro"><i class="fa fa-check"></i><b>2.5</b> The macro recorder</a></li>
<li class="chapter" data-level="2.6" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-overview"><i class="fa fa-check"></i><b>2.6</b> VBA - A short overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#variables"><i class="fa fa-check"></i><b>2.6.1</b> Variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#procedures"><i class="fa fa-check"></i><b>2.6.2</b> Procedures</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#input-and-output"><i class="fa fa-check"></i><b>2.6.3</b> Input and output</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#conditional-statements"><i class="fa fa-check"></i><b>2.6.4</b> Conditional statements</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#loops"><i class="fa fa-check"></i><b>2.6.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-coding-practice"><i class="fa fa-check"></i><b>2.7</b> Good coding pratice</a></li>
<li class="chapter" data-level="2.8" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#rc-vba-intro"><i class="fa fa-check"></i><b>2.8</b> Recap</a></li>
<li class="chapter" data-level="2.9" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-intro"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-hello"><i class="fa fa-check"></i><b>2.9.1</b> Exercise - Hello</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-macro"><i class="fa fa-check"></i><b>2.9.2</b> Exercise - Record a macro</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-user-input"><i class="fa fa-check"></i><b>2.9.3</b> Exercise - User input</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-max-min"><i class="fa fa-check"></i><b>2.9.4</b> Exercise - Max and min number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html"><i class="fa fa-check"></i><b>3</b> Loops and conditional statements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#lo-vba-loops-cond"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-operators"><i class="fa fa-check"></i><b>3.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="3.3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-loops"><i class="fa fa-check"></i><b>3.3</b> Loops</a></li>
<li class="chapter" data-level="3.4" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-cond"><i class="fa fa-check"></i><b>3.4</b> Conditional statements</a></li>
<li class="chapter" data-level="3.5" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-jen"><i class="fa fa-check"></i><b>3.5</b> Example - Find Jen</a></li>
<li class="chapter" data-level="3.6" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-dist-mat"><i class="fa fa-check"></i><b>3.6</b> Example - A distance matrix</a></li>
<li class="chapter" data-level="3.7" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#recap"><i class="fa fa-check"></i><b>3.7</b> Recap</a></li>
<li class="chapter" data-level="3.8" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops-cond"><i class="fa fa-check"></i><b>3.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops"><i class="fa fa-check"></i><b>3.8.1</b> Exercise - Loops</a></li>
<li class="chapter" data-level="3.8.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-cond"><i class="fa fa-check"></i><b>3.8.2</b> Exercise - Conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html"><i class="fa fa-check"></i><b>4</b> Procedures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#lo-vba-procedures"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-subs-functions"><i class="fa fa-check"></i><b>4.2</b> Subs and functions - The basics</a></li>
<li class="chapter" data-level="4.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-optional-arg"><i class="fa fa-check"></i><b>4.3</b> Optional arguments</a></li>
<li class="chapter" data-level="4.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-pub-priv"><i class="fa fa-check"></i><b>4.4</b> Public and private procedures</a></li>
<li class="chapter" data-level="4.5" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-byref"><i class="fa fa-check"></i><b>4.5</b> Passing arguments by reference or by value</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#return-values-from-a-sub"><i class="fa fa-check"></i><b>4.5.1</b> Return values from a sub</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-built-in"><i class="fa fa-check"></i><b>4.6</b> Built-in functions</a></li>
<li class="chapter" data-level="4.7" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-test-persons"><i class="fa fa-check"></i><b>4.7</b> Example - Selection of test persons</a></li>
<li class="chapter" data-level="4.8" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#recap-1"><i class="fa fa-check"></i><b>4.8</b> Recap</a></li>
<li class="chapter" data-level="4.9" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-procedures"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-subs"><i class="fa fa-check"></i><b>4.9.1</b> Exercise - Subs</a></li>
<li class="chapter" data-level="4.9.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#exercise---temperatures"><i class="fa fa-check"></i><b>4.9.2</b> Exercise - Temperatures</a></li>
<li class="chapter" data-level="4.9.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-functions"><i class="fa fa-check"></i><b>4.9.3</b> Exercise - Functions</a></li>
<li class="chapter" data-level="4.9.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-worksheet-functions"><i class="fa fa-check"></i><b>4.9.4</b> Exercise - Worksheet functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html"><i class="fa fa-check"></i><b>5</b> Advanced data types and usage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#lo-vba-datatypes"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-strings"><i class="fa fa-check"></i><b>5.2</b> Strings</a></li>
<li class="chapter" data-level="5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-objects"><i class="fa fa-check"></i><b>5.3</b> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-wst"><i class="fa fa-check"></i><b>5.4</b> The Worksheet object</a></li>
<li class="chapter" data-level="5.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#wst-rng"><i class="fa fa-check"></i><b>5.5</b> The Range object</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#current-region-of-a-range"><i class="fa fa-check"></i><b>5.5.1</b> Current region of a range</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-1"><i class="fa fa-check"></i><b>5.5.2</b> Input and output</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-a-range"><i class="fa fa-check"></i><b>5.5.3</b> Sorting a range</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ary"><i class="fa fa-check"></i><b>5.6</b> Arrays</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#multi-dimensional-arrays"><i class="fa fa-check"></i><b>5.6.1</b> Multi-dimensional arrays</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#dynamic-arrays"><i class="fa fa-check"></i><b>5.6.2</b> Dynamic arrays</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-2"><i class="fa fa-check"></i><b>5.6.3</b> Input and output</a></li>
<li class="chapter" data-level="5.6.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-arrays"><i class="fa fa-check"></i><b>5.6.4</b> Sorting arrays</a></li>
<li class="chapter" data-level="5.6.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges"><i class="fa fa-check"></i><b>5.6.5</b> Use arrays instead of ranges</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-coll"><i class="fa fa-check"></i><b>5.7</b> Collections</a></li>
<li class="chapter" data-level="5.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ex-job-seq"><i class="fa fa-check"></i><b>5.8</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="5.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#recap-2"><i class="fa fa-check"></i><b>5.9</b> Recap</a></li>
<li class="chapter" data-level="5.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-datatypes"><i class="fa fa-check"></i><b>5.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-equal"><i class="fa fa-check"></i><b>5.10.1</b> Exercise - Equal entries</a></li>
<li class="chapter" data-level="5.10.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-products"><i class="fa fa-check"></i><b>5.10.2</b> Exercise - Product search</a></li>
<li class="chapter" data-level="5.10.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-collections"><i class="fa fa-check"></i><b>5.10.3</b> Exercise - Read collections</a></li>
<li class="chapter" data-level="5.10.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-arrays"><i class="fa fa-check"></i><b>5.10.4</b> Exercise - Read arrays</a></li>
<li class="chapter" data-level="5.10.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-flight"><i class="fa fa-check"></i><b>5.10.5</b> Exercise - Flight search</a></li>
<li class="chapter" data-level="5.10.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-byref"><i class="fa fa-check"></i><b>5.10.6</b> Exercise - <code>ByRef</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html"><i class="fa fa-check"></i><b>6</b> Generating random numbers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#lo-vba-random-numbers"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-random-numbers"><i class="fa fa-check"></i><b>6.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="6.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-simulation"><i class="fa fa-check"></i><b>6.3</b> Simulation</a></li>
<li class="chapter" data-level="6.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#recap-3"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
<li class="chapter" data-level="6.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-numbers"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-generate"><i class="fa fa-check"></i><b>6.5.1</b> Exercise - Generating random numbers</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-tsp"><i class="fa fa-check"></i><b>6.5.2</b> Exercise - Traveling salesman problem</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-bakery"><i class="fa fa-check"></i><b>6.5.3</b> Exercise - Dan’s bakery</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#joint-r-project-structure"><i class="fa fa-check"></i>Joint R project structure</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate the course notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a></li>
<li class="chapter" data-level="D" data-path="coding-convention.html"><a href="coding-convention.html"><i class="fa fa-check"></i><b>D</b> Coding/naming convention</a>
<ul>
<li class="chapter" data-level="D.1" data-path="coding-convention.html"><a href="coding-convention.html#commenting-your-code"><i class="fa fa-check"></i><b>D.1</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="apdx-vba.html"><a href="apdx-vba.html"><i class="fa fa-check"></i><b>E</b> VBA specific topics</a>
<ul>
<li class="chapter" data-level="E.1" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-debug"><i class="fa fa-check"></i><b>E.1</b> Debugging your code</a></li>
<li class="chapter" data-level="E.2" data-path="apdx-vba.html"><a href="apdx-vba.html#error-handling"><i class="fa fa-check"></i><b>E.2</b> Error handling</a></li>
<li class="chapter" data-level="E.3" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-course-procedures"><i class="fa fa-check"></i><b>E.3</b> Course procedures</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lg-course.html"><a href="lg-course.html"><i class="fa fa-check"></i><b>F</b> Learning goals</a></li>
<li class="chapter" data-level="G" data-path="ba.html"><a href="ba.html"><i class="fa fa-check"></i><b>G</b> Business Analytics</a></li>
<li class="chapter" data-level="H" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>H</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-vba-random-numbers" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Module 6</span> Generating random numbers<a href="mod-vba-random-numbers.html#mod-vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module gives a short introduction on how to generate random numbers and using them in a simulation.
<strong>Learning path diagram</strong></p>
<p>Click/hover the nodes to follow links and see details.</p>
<div id="htmlwidget-e5dcd25fa9581fe10fe3" style="width:100%;height:200px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5dcd25fa9581fe10fe3">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"📖 Random numbers\", URL = \"#vba-random-numbers\", tooltip = \"Random numbers\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", width = \"0.5\", fillcolor = \"DarkSeaGreen4\", pos = \"2,1!\"] \n  \"2\" [label = \"📖 Simulation\", URL = \"#vba-simulation\", tooltip = \"Simulation\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", width = \"0.5\", fillcolor = \"DarkSeaGreen4\", pos = \"5,1!\"] \n  \"3\" [label = \"💻 Exercises\", URL = \"#ex-vba-random-numbers\", tooltip = \"Exercises\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", width = \"0.5\", fillcolor = \"DarkSeaGreen4\", pos = \"8,1!\"] \n  \"4\" [label = \"\", URL = \"\", tooltip = \" \", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"0.5\", fontname = \"Helvetica\", shape = \"rect\", height = \"1\", width = \"6\", fillcolor = \"#F0F8FF\", pos = \"4.1,-0.34!\"] \n  \"5\" [label = \"Color:\", URL = \"\", tooltip = \" \", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"black\", penwidth = \"0\", fontname = \"Helvetica\", shape = \"none\", height = \"0\", width = \"0.8\", fillcolor = \"#FFFFFE\", pos = \"1.47,0!\"] \n  \"6\" [label = \"mandatory\", URL = \"\", tooltip = \"Mandatory syllabus.\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", width = \"0.8\", fillcolor = \"DarkSeaGreen4\", pos = \"1.7,-0.4!\"] \n  \"7\" [label = \"alternative\", URL = \"\", tooltip = \"Alternative syllabus if you prefer another learning style.\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", width = \"0.8\", fillcolor = \"DarkOrange4\", pos = \"2.7,-0.4!\"] \n  \"8\" [label = \"extra\", URL = \"\", tooltip = \"Extra learning if you are interested (not part of syllabus).\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", width = \"0.8\", fillcolor = \"PeachPuff3\", pos = \"3.7,-0.4!\"] \n  \"9\" [label = \"Shape:\", URL = \"\", tooltip = \" \", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"black\", penwidth = \"0\", fontname = \"Helvetica\", shape = \"none\", height = \"0\", width = \"1\", fillcolor = \"#FFFFFE\", pos = \"4.9,0!\"] \n  \"10\" [label = \"non-interactive\", URL = \"\", tooltip = \"Non-interactive learning content (e.g. reading).\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", width = \"1\", fillcolor = \"Grey40\", pos = \"5.2,-0.4!\"] \n  \"11\" [label = \"interactive\", URL = \"\", tooltip = \"Interactive learning content (tutorial, exercises etc.).\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"egg\", width = \"1\", fillcolor = \"Grey40\", pos = \"6.45,-0.4!\"] \n\"1\"->\"2\" [color = \"black\", arrowhead = \"vee\"] \n\"2\"->\"3\" [color = \"black\", arrowhead = \"vee\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div id="lo-vba-random-numbers" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Learning outcomes<a href="mod-vba-random-numbers.html#lo-vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this module, you are expected to be able to:</p>
<ul>
<li>Describe what a random number is.</li>
<li>Generate a random number from a distribution.</li>
<li>Run a simulation and compare/analyse results.</li>
</ul>
<p>The learning outcomes relate to the <a href="lg-course.html#lg-course">overall learning goals</a> number 2-4, 8-14 and 16 of the course.</p>
<!-- SOLO increasing: identify · memorise · name · do simple procedure · collect data · -->
<!-- enumerate · describe · interpret · formulate · list · paraphrase · combine · do -->
<!-- algorithms · compare · contrast · explain causes · analyse · relate · derive · -->
<!-- evaluate · apply · argue · theorise · generalise · hypothesise · solve · reflect -->
</div>
<div id="vba-random-numbers" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Generating random numbers<a href="mod-vba-random-numbers.html#vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often we want to model a system where some of the elements are uncertain. To simulate the system we want to generate some random numbers following different distributions. This can be done using the built-in VBA and Excel functions.</p>
<p>Read Sections 18.1 of Chapter 18 in <span class="citation">Wøhlk (<a href="#ref-vba-book" role="doc-biblioref">2010</a>)</span>.</p>
</div>
<div id="vba-simulation" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Simulation<a href="mod-vba-random-numbers.html#vba-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given an uncertain system we simulate the system by constructing a deterministic model (that is we assume the random numbers have some specific values) and algorithms for solving it. Next, random numbers are generated and used to solve the model and store the results. This is repeated a number of times and statistics such as min, mean, standard deviation or max value of a statistic can be found.</p>
<p>Read Sections 18.2 of Chapter 18 in <span class="citation">Wøhlk (<a href="#ref-vba-book" role="doc-biblioref">2010</a>)</span>.</p>
</div>
<div id="recap-3" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Recap<a href="mod-vba-random-numbers.html#recap-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Often we want to model a system where some of the elements are uncertain. To simulate the system we want to generate some random numbers following different distributions. This can be done using the built-in VBA and Excel functions.</p></li>
<li><p>Initialize generation of random numbers using</p>
<pre><code>Randomize()     &#39; chooses a random seed </code></pre>
<p>Or</p>
<pre><code>Randomize(100)     &#39; generate the same random numbers</code></pre>
<p>We normally use the first option.</p></li>
<li><p>When generating random numbers in VBA and writing them to the worksheet, they will NOT be changed when the worksheet is updated! Only when the code is executed!</p></li>
<li><p>Examples on some distributions are</p>
<ul>
<li>Uniform between 0 and 1: <code>Rnd()</code></li>
<li>Uniform between i and j: <code>i + (j - i) * Rnd</code></li>
<li>Normal distribution: <code>WorksheetFunction.NormInv(Rnd, dblMean, dblSD)</code></li>
<li>Binomial distribution: <code>WorksheetFunction.Binom_Inv(intTrials, dblPr, Rnd)</code></li>
</ul></li>
<li><p>Given an uncertain system we simulate the system by constructing a</p>
<ul>
<li>Deterministic model (that is we assume the random numbers have some specific values) and algorithms for solving it.</li>
<li>Generate random numbers and used to solve the model and store the results.</li>
<li>Repeat a number of times and calculate statistics such as min, mean and standard deviation.</li>
</ul></li>
</ul>
<p>You may also have a look at the <a href="https://bss-osca.github.io/tfa/slides/03-01_vba-random-numbers-slides.html">slides for this module</a>.</p>
</div>
<div id="ex-vba-random-numbers" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Exercises<a href="mod-vba-random-numbers.html#ex-vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below you will find a set of exercises. Always have a look at the exercises before you meet in your study group and try to solve them yourself. Are you stuck, see the <a href="help.html#help">help page</a>. Some of the solutions to each exercise can be seen by pressing the button at each question. Beware, you will not learn by giving up too early. Put some effort into finding a solution!</p>
<div id="ex-vba-generate" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Exercise - Generating random numbers<a href="mod-vba-random-numbers.html#ex-vba-generate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This <a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-generate-template.xlsm">file</a> should be used as a starting point for this exercise.</p>
<ol style="list-style-type: decimal">
<li>Create a procedure <code>GenNormal</code> with arguments <code>intSize</code>, <code>dblMean</code>, <code>dblSD</code> and <code>ary</code>. The procedure must generate <code>intSize</code> random numbers from a normal distribution with mean <code>dblMean</code> and standard deviation <code>dblSD</code>. The procedure must store the values in <code>ary</code>.</li>
<li>Create a procedure <code>GenUniform</code> with arguments <code>intSize</code>, <code>dblMin</code>, <code>dblMax</code> and <code>ary</code>. The procedure must generate <code>intSize</code> random numbers from a uniform distribution in the range <code>dblMin</code> to <code>dblMax</code>. The procedure must store the values in <code>ary</code>.</li>
<li>Create a procedure <code>GenBinomial</code> with arguments <code>intSize</code>, <code>intTrials</code>, <code>dblPr</code> and <code>ary</code>. The procedure must generate <code>intSize</code> random numbers from a binomial distribution using <code>intTrials</code> trials with <code>dblPr</code> probability of success. The procedure must store the values in <code>ary</code>.</li>
<li>Create a procedure <code>GenPoisson</code> with arguments <code>intSize</code>, <code>dblLambda</code> and <code>ary</code>. The procedure must generate <code>intSize</code> random numbers from a poisson distribution with mean <code>dblLambda</code>. The procedure must store the values in <code>ary</code>. You may use the <code>PoissonInv</code> function.</li>
<li>Create a procedure <code>GenDiscrete</code> with arguments <code>intSize</code>, <code>dblDens</code> and <code>ary</code>. The procedure must generate <code>intSize</code> random numbers from a discrete distribution with density <code>dblDens</code> (first column in the array contains the outcome and the second the probability). The procedure must store the values in <code>ary</code>. You may use the <code>DiscreteInv</code> function.</li>
<li>Create a procedure <code>Main</code> that generate 5000 random numbers of
<ul>
<li>A normal distribution with mean 100 and standard deviation 20.</li>
<li>An uniform distribution with range 10 to 500.</li>
<li>A binomial distribution with 100 trials and a 0.2 probability of success.</li>
<li>A poisson distribution with mean 5.</li>
<li>Plot the results for each distribution using <code>CreatePlot</code>.</li>
</ul></li>
</ol>
</div>
<div id="ex-vba-tsp" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Exercise - Traveling salesman problem<a href="mod-vba-random-numbers.html#ex-vba-tsp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This <a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-tsp-template.xlsm">file</a> should be used as a starting point for this exercise.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">travelling salesman problem</a> (TSP) asks the following question:</p>
<blockquote>
<p>Given a list of cities and the distances between each pair of the cities,
what is the shortest possible route that visits each city exactly once
and returns to the origin city?</p>
</blockquote>
<p>The problem is an NP-hard problem (worst case solution time grows exponential with the number of cities) in combinatorial optimization, important in theoretical computer science and operations research. The problem was first formulated in 1930 and is one of the most intensively studied problems in optimization. Even though the problem is computationally difficult, many heuristics and exact algorithms are known.</p>
<p>The goal with this exercise is to test different heuristics on a set of problem instances. To see which one works best.</p>
<ol style="list-style-type: decimal">
<li>Create a procedure <code>GenTSPData</code> satisfying:
<ul>
<li>Arguments are <code>ByRef dblCoord() As Double, Optional intCities As Integer = 0, Optional blnPrint As Boolean = False</code>.</li>
<li>Each city has an id number and a x and y-coordinate.</li>
<li>The generated cities are stored in array <code>dblCoord</code> with <code>intCities</code> rows and three columns (column 1 store the city id, column 2 the x-coordinate and column 3 the y-coordinate)</li>
<li>The x and y-coordinates are random numbers from an uniform distribution between 0 and 10.</li>
<li>If <code>blnPrint</code> is true then coordinates are printed to the main sheet starting in cell A2.</li>
<li>If <code>intCities</code> is zero then use an input box to ask for the number of cities.<br />
</li>
</ul></li>
<li>Create a procedure <code>BtnGenTSPData</code> that calls <code>GenTSPData</code>, ask for the number of cities and print the result to cell A2. A button linking to the procedure has already been created in the template file.</li>
<li>Create a procedure <code>CalcDistArray</code> satisfying:
<ul>
<li>Arguments are <code>ByRef dblDist() As Double, dblCoord() As Double</code> where <code>dblCoord</code> are the coordinates found using <code>GenTSPData</code>.</li>
<li>The distance between two cities are stored in <code>dblDist</code>, i.e. <code>dblDist(i, j)</code> store the distance between city <code>i</code> and <code>j</code>.</li>
<li>Symmetric distances are assumed, i.e. <code>dblDist(i, j) = dblDist(j, i)</code>.</li>
</ul></li>
<li>Create a procedure <code>SolveTSPIncX</code> satisfying:
<ul>
<li>Arguments are <code>dblCoord() As Double, dblDist() As Double, ByRef dblCost As Double, ByRef intSeq() As Integer</code></li>
<li>Sort the array <code>dblCoord</code> increasing in the x-coordinate (you may use the procedure <code>ArySort</code> in module <code>ModuleAry</code> to do this).</li>
<li>Visit the cities in the order of the sorted array and return to the starting city.</li>
<li>The visiting city sequence are stored in <code>intSeq</code>.</li>
<li>The total cost are stored in <code>dblCost</code>. You may use the <code>CalcCost</code> function to find the total cost.</li>
</ul></li>
<li>Create a procedure <code>BtnSolveTSPIncX</code> that calls <code>SolveTSPIncX</code> using the TSP data in the Main sheet and print out the total cost in cell H4. A button linking to the procedure has already been created.</li>
<li>Create a procedure <code>SolveTSPIncY</code> satisfying:
<ul>
<li>Arguments are <code>dblCoord() As Double, dblDist() As Double, ByRef dblCost As Double, ByRef intSeq() As Integer</code></li>
<li>Sort the array <code>dblCoord</code> increasing in the y-coordinate (you may use the procedure <code>ArySort</code> in module <code>ModuleAry</code> to do this).</li>
<li>Visit the cities in the order of the sorted array and return to the starting city.</li>
<li>The visiting city sequence are stored in <code>intSeq</code>.</li>
<li>The total cost are stored in <code>dblCost</code>. You may use the <code>CalcCost</code> function to find the total cost.</li>
</ul></li>
<li>Create a procedure <code>BtnSolveTSPIncY</code> that calls <code>SolveTSPIncY</code> using the TSP data in the Main sheet and print out the total cost in cell H8. A button linking to the procedure has already been created.</li>
<li>Create a procedure <code>SolveTSPRand</code> satisfying:
<ul>
<li>Arguments are <code>dblCoord() As Double, dblDist() As Double, ByRef dblCost As Double, ByRef intSeq() As Integer</code></li>
<li>Visit the cities in the order of the <code>dblCoord</code> array and return to the starting city. This may seen as we visit the cities in random order since generate x and y-coordinate random.</li>
<li>The visiting city sequence are stored in <code>intSeq</code>.</li>
<li>The total cost are stored in <code>dblCost</code>. You may use the <code>CalcCost</code> function to find the total cost.</li>
</ul></li>
<li>Create a procedure <code>BtnSolveTSPRand</code> that calls <code>SolveTSPRand</code> using the TSP data in the Main sheet and print out the total cost in cell H11. A button linking to the procedure has already been created.</li>
<li>Create a procedure <code>SolveTSPNN</code> satisfying:
<ul>
<li>Arguments are <code>dblCoord() As Double, dblDist() As Double, ByRef dblCost As Double, ByRef intSeq() As Integer</code></li>
<li>Start in city 1.</li>
<li>Given the current city find the next city (not already visited) as the city with shortest distance.</li>
<li>The visiting city sequence are stored in <code>intSeq</code>.</li>
<li>The total cost are stored in <code>dblCost</code>. You may use the <code>CalcCost</code> function to find the total cost.</li>
</ul></li>
<li>Create a procedure <code>BtnSolveTSPNN</code> that calls <code>SolveTSPNN</code> using the TSP data in the Main sheet and print out the total cost in cell H14. A button linking to the procedure has already been created.</li>
<li>Create a procedure <code>Simulation</code> satisfying:
<ul>
<li>Generate an instance of TSP data with <code>intCities</code> cities which are chosen random between 10 and 500.</li>
<li>Calculate the distance matrix.</li>
<li>Solve the instance using all of the above solutions algorithms.</li>
<li>Store the result in a row in the <em>Simulation</em> sheet.</li>
<li>Repeat 100 times and calculate min, mean and max values for each solution algorithm.</li>
</ul>
Have a look at sheet <em>Simulation example</em> for an example. Note you do not have to print the coordinates out to the <em>Main</em> sheet.</li>
<li>Which solution algorithm seems to give the shortest total travel distance?</li>
</ol>
</div>
<div id="ex-vba-bakery" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Exercise - Dan’s bakery<a href="mod-vba-random-numbers.html#ex-vba-bakery" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This <a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-bakery-template.xlsm">file</a> should be used as a starting point for this exercise.</p>
<p>Dan owns a small bakery baking a single cold-rised bread. The demand level <span class="math inline">\(l\)</span> for bread is uncertain and on a given day the demand level equals <span class="math inline">\(l=1\)</span> (low) with probability 0.2, <span class="math inline">\(l=2\)</span> (medium) with probability 0.5 and <span class="math inline">\(l=3\)</span> (high) with probability 0.3. The actual demand (number of customers) depends on the demand level and is Poisson distributed with mean <span class="math inline">\(50 + 20l\)</span>. The sales price per bread is 45 DKK and production cost 7 DKK. If a customer arrives and Dan has no bread left then he estimates the loss of goodwill to be 10 DKK. A customer always buy one bread. Dan can have 20 breads in the oven a time and hence always produce a multiple of 20 breads.</p>
<ol style="list-style-type: decimal">
<li>Create a function <code>Profit</code> that returns the daily profit given a specific demand and production.</li>
<li>Create a procedure <code>Simulate</code> that simulate the system for <span class="math inline">\(y\)</span> days given that Dan choose to produce <span class="math inline">\(x\)</span> breads each day. Number of runs (days), production, price, production cost, and lost goodwill cost instead of contribution margin and lost goodwill, average profit, standard deviation, min and max profit should be returned in an array. You may use functions <code>DiscreteInv</code> and <code>PoissonInv</code> to generate numbers.</li>
<li>Create a procedure <code>BtnSimulate</code> that calls <code>Simulate</code> for different production levels and output the results in sheet <em>Simulation</em>.</li>
<li>Is it best for Pierre to produce 80 or 120 breads?</li>
<li>Create a function <code>OptimalProd</code> that search for the optimal production using the following steps:
<ul>
<li>Start with production of 20 bread.</li>
<li>Calculate the average profit based on 500 simulations.</li>
<li>Increase the production with 20 breads unit until no better average profit is found.</li>
<li>Return the production found.</li>
</ul></li>
<li>Test it on the data in sheet <em>OptimalProd</em>.</li>
</ol>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-vba-book" class="csl-entry">
Wøhlk, S. 2010. <em>VBA Programming in Business Economics</em>. DJØF Publishing.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-vba-datatypes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="groups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bss-osca/tfa/edit/master/book/06_vba-random-numbers.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
