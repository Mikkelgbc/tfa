<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 5 Functions | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course (R part)" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 5 Functions | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bss-osca.github.io/tfa/" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa/assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course (R part)" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 5 Functions | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course (R part)" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa/assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2020-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="sec-loops.html"/>
<link rel="next" href="sec-tidy-intro.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/font-awesome-5.3.1/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-5.3.1/css/v4-shims.min.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<html>
<head>
<!--<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>-->
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-this-book-is-organised"><i class="fa fa-check"></i><b>1.1</b> How this book is organised</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.2</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Getting started</b></span></li>
<li class="chapter" data-level="2" data-path="sec-install.html"><a href="sec-install.html"><i class="fa fa-check"></i><b>2</b> Install R and RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sec-install.html"><a href="sec-install.html#lo-install"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="sec-install.html"><a href="sec-install.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R and RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="sec-install.html"><a href="sec-install.html#test-your-installation"><i class="fa fa-check"></i><b>2.3</b> Test your installation</a></li>
<li class="chapter" data-level="2.4" data-path="sec-install.html"><a href="sec-install.html#add-on-packages"><i class="fa fa-check"></i><b>2.4</b> Add-on packages</a></li>
<li class="chapter" data-level="2.5" data-path="sec-install.html"><a href="sec-install.html#lp-install"><i class="fa fa-check"></i><b>2.5</b> Different learning paths</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-r-basics.html"><a href="sec-r-basics.html"><i class="fa fa-check"></i><b>3</b> R basics and workflows</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sec-r-basics.html"><a href="sec-r-basics.html#lo-r-basics"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="sec-r-basics.html"><a href="sec-r-basics.html#working-with-r-at-the-command-line-in-rstudio"><i class="fa fa-check"></i><b>3.2</b> Working with R at the command line in RStudio</a></li>
<li class="chapter" data-level="3.3" data-path="sec-r-basics.html"><a href="sec-r-basics.html#your-first-datacamp-course"><i class="fa fa-check"></i><b>3.3</b> Your first DataCamp course</a></li>
<li class="chapter" data-level="3.4" data-path="sec-r-basics.html"><a href="sec-r-basics.html#pipes"><i class="fa fa-check"></i><b>3.4</b> Pipes</a></li>
<li class="chapter" data-level="3.5" data-path="sec-r-basics.html"><a href="sec-r-basics.html#rprojs"><i class="fa fa-check"></i><b>3.5</b> RStudio projects</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="sec-r-basics.html"><a href="sec-r-basics.html#storing-your-code-in-a-script-file"><i class="fa fa-check"></i><b>3.5.1</b> Storing your code in a script file</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="sec-r-basics.html"><a href="sec-r-basics.html#global-options"><i class="fa fa-check"></i><b>3.6</b> Global options</a></li>
<li class="chapter" data-level="3.7" data-path="sec-r-basics.html"><a href="sec-r-basics.html#working-directory"><i class="fa fa-check"></i><b>3.7</b> Working directory</a></li>
<li class="chapter" data-level="3.8" data-path="sec-r-basics.html"><a href="sec-r-basics.html#lp-r-basics"><i class="fa fa-check"></i><b>3.8</b> Different learning paths</a></li>
<li class="chapter" data-level="3.9" data-path="sec-r-basics.html"><a href="sec-r-basics.html#rc-r-basics"><i class="fa fa-check"></i><b>3.9</b> Recap</a></li>
<li class="chapter" data-level="3.10" data-path="sec-r-basics.html"><a href="sec-r-basics.html#ex-r-basics"><i class="fa fa-check"></i><b>3.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-group-work"><i class="fa fa-check"></i><b>3.10.1</b> Exercise (group work)*</a></li>
<li class="chapter" data-level="3.10.2" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-install-packages"><i class="fa fa-check"></i><b>3.10.2</b> Exercise (install packages)</a></li>
<li class="chapter" data-level="3.10.3" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-piping"><i class="fa fa-check"></i><b>3.10.3</b> Exercise (piping)</a></li>
<li class="chapter" data-level="3.10.4" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-working-dir"><i class="fa fa-check"></i><b>3.10.4</b> Exercise (working dir)</a></li>
<li class="chapter" data-level="3.10.5" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-vectors"><i class="fa fa-check"></i><b>3.10.5</b> Exercise (vectors)</a></li>
<li class="chapter" data-level="3.10.6" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-matrices"><i class="fa fa-check"></i><b>3.10.6</b> Exercise (matrices)</a></li>
<li class="chapter" data-level="3.10.7" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-data-frames"><i class="fa fa-check"></i><b>3.10.7</b> Exercise (data frames)</a></li>
<li class="chapter" data-level="3.10.8" data-path="sec-r-basics.html"><a href="sec-r-basics.html#exercise-lists"><i class="fa fa-check"></i><b>3.10.8</b> Exercise (lists)</a></li>
<li class="chapter" data-level="3.10.9" data-path="sec-r-basics.html"><a href="sec-r-basics.html#ex-strings"><i class="fa fa-check"></i><b>3.10.9</b> Exercise (string management)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Programming in R</b></span></li>
<li class="chapter" data-level="4" data-path="sec-loops.html"><a href="sec-loops.html"><i class="fa fa-check"></i><b>4</b> Loops and conditionals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sec-loops.html"><a href="sec-loops.html#lo-loops"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="sec-loops.html"><a href="sec-loops.html#conditionals-and-control-flow"><i class="fa fa-check"></i><b>4.2</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="4.3" data-path="sec-loops.html"><a href="sec-loops.html#loops"><i class="fa fa-check"></i><b>4.3</b> Loops</a></li>
<li class="chapter" data-level="4.4" data-path="sec-loops.html"><a href="sec-loops.html#lp-loops"><i class="fa fa-check"></i><b>4.4</b> Different learning paths</a></li>
<li class="chapter" data-level="4.5" data-path="sec-loops.html"><a href="sec-loops.html#rc-loops"><i class="fa fa-check"></i><b>4.5</b> Recap</a></li>
<li class="chapter" data-level="4.6" data-path="sec-loops.html"><a href="sec-loops.html#ex-loops"><i class="fa fa-check"></i><b>4.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="sec-loops.html"><a href="sec-loops.html#exercise-conditional-expressions"><i class="fa fa-check"></i><b>4.6.1</b> Exercise (conditional expressions)</a></li>
<li class="chapter" data-level="4.6.2" data-path="sec-loops.html"><a href="sec-loops.html#exercise-loops"><i class="fa fa-check"></i><b>4.6.2</b> Exercise (loops)</a></li>
<li class="chapter" data-level="4.6.3" data-path="sec-loops.html"><a href="sec-loops.html#ex-dist"><i class="fa fa-check"></i><b>4.6.3</b> Exercise (calculating distances)</a></li>
<li class="chapter" data-level="4.6.4" data-path="sec-loops.html"><a href="sec-loops.html#exercise-expand_grid"><i class="fa fa-check"></i><b>4.6.4</b> Exercise (<code>expand_grid</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-functions.html"><a href="sec-functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sec-functions.html"><a href="sec-functions.html#lo-functions"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="sec-functions.html"><a href="sec-functions.html#datacamp-course"><i class="fa fa-check"></i><b>5.2</b> DataCamp course</a></li>
<li class="chapter" data-level="5.3" data-path="sec-functions.html"><a href="sec-functions.html#functions-returning-multiple-objects"><i class="fa fa-check"></i><b>5.3</b> Functions returning multiple objects</a></li>
<li class="chapter" data-level="5.4" data-path="sec-functions.html"><a href="sec-functions.html#the-...-argument"><i class="fa fa-check"></i><b>5.4</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="5.5" data-path="sec-functions.html"><a href="sec-functions.html#documenting-your-functions"><i class="fa fa-check"></i><b>5.5</b> Documenting your functions</a></li>
<li class="chapter" data-level="5.6" data-path="sec-functions.html"><a href="sec-functions.html#lp-functions"><i class="fa fa-check"></i><b>5.6</b> Different learning paths</a></li>
<li class="chapter" data-level="5.7" data-path="sec-functions.html"><a href="sec-functions.html#rc-functions"><i class="fa fa-check"></i><b>5.7</b> Recap</a></li>
<li class="chapter" data-level="5.8" data-path="sec-functions.html"><a href="sec-functions.html#ex-functions"><i class="fa fa-check"></i><b>5.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="sec-functions.html"><a href="sec-functions.html#exercise-defining-functions"><i class="fa fa-check"></i><b>5.8.1</b> Exercise (defining functions)</a></li>
<li class="chapter" data-level="5.8.2" data-path="sec-functions.html"><a href="sec-functions.html#exercise-scope"><i class="fa fa-check"></i><b>5.8.2</b> Exercise (scope)</a></li>
<li class="chapter" data-level="5.8.3" data-path="sec-functions.html"><a href="sec-functions.html#exercise-job-sequencing"><i class="fa fa-check"></i><b>5.8.3</b> Exercise (job sequencing)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III IO, tidy and transform</b></span></li>
<li class="chapter" data-level="6" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html"><i class="fa fa-check"></i><b>6</b> Introduction to tidyverse and R Markdown</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#lo-tidy-intro"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#the-tidyverse-package"><i class="fa fa-check"></i><b>6.2</b> The tidyverse package</a></li>
<li class="chapter" data-level="6.3" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#writing-reproducible-reports"><i class="fa fa-check"></i><b>6.3</b> Writing reproducible reports</a></li>
<li class="chapter" data-level="6.4" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#tibbles"><i class="fa fa-check"></i><b>6.4</b> Tibbles</a></li>
<li class="chapter" data-level="6.5" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#lp-tidy-intro"><i class="fa fa-check"></i><b>6.5</b> Different learning paths</a></li>
<li class="chapter" data-level="6.6" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#rc-tidy-intro"><i class="fa fa-check"></i><b>6.6</b> Recap</a></li>
<li class="chapter" data-level="6.7" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#ex-tidy-intro"><i class="fa fa-check"></i><b>6.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#exercise-your-first-r-markdown-exercise"><i class="fa fa-check"></i><b>6.7.1</b> Exercise (your first R Markdown exercise)</a></li>
<li class="chapter" data-level="6.7.2" data-path="sec-tidy-intro.html"><a href="sec-tidy-intro.html#exercise-tibbles"><i class="fa fa-check"></i><b>6.7.2</b> Exercise (tibbles)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sec-io.html"><a href="sec-io.html"><i class="fa fa-check"></i><b>7</b> Importing and exporting data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-io.html"><a href="sec-io.html#lo-io"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="sec-io.html"><a href="sec-io.html#csv-files"><i class="fa fa-check"></i><b>7.2</b> CSV files</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sec-io.html"><a href="sec-io.html#reading-a-csv-file"><i class="fa fa-check"></i><b>7.2.1</b> Reading a CSV file</a></li>
<li class="chapter" data-level="7.2.2" data-path="sec-io.html"><a href="sec-io.html#writing-to-csv-files"><i class="fa fa-check"></i><b>7.2.2</b> Writing to CSV files</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-io.html"><a href="sec-io.html#excel"><i class="fa fa-check"></i><b>7.3</b> Excel</a></li>
<li class="chapter" data-level="7.4" data-path="sec-io.html"><a href="sec-io.html#google-sheets"><i class="fa fa-check"></i><b>7.4</b> Google Sheets</a></li>
<li class="chapter" data-level="7.5" data-path="sec-io.html"><a href="sec-io.html#text-files"><i class="fa fa-check"></i><b>7.5</b> Text files</a></li>
<li class="chapter" data-level="7.6" data-path="sec-io.html"><a href="sec-io.html#rs-native-binary-format"><i class="fa fa-check"></i><b>7.6</b> R’s native binary format</a></li>
<li class="chapter" data-level="7.7" data-path="sec-io.html"><a href="sec-io.html#json"><i class="fa fa-check"></i><b>7.7</b> Json</a></li>
<li class="chapter" data-level="7.8" data-path="sec-io.html"><a href="sec-io.html#lp-io"><i class="fa fa-check"></i><b>7.8</b> Different learning paths</a></li>
<li class="chapter" data-level="7.9" data-path="sec-io.html"><a href="sec-io.html#rc-io"><i class="fa fa-check"></i><b>7.9</b> Recap</a></li>
<li class="chapter" data-level="7.10" data-path="sec-io.html"><a href="sec-io.html#ex-io"><i class="fa fa-check"></i><b>7.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="sec-io.html"><a href="sec-io.html#exercise-statistikbanken"><i class="fa fa-check"></i><b>7.10.1</b> Exercise (Statistikbanken)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-transform.html"><a href="sec-transform.html"><i class="fa fa-check"></i><b>8</b> Transforming data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sec-transform.html"><a href="sec-transform.html#lo-transform"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
</ul></li>
<li class="part"><span><b>IV Visualization</b></span></li>
<li class="chapter" data-level="9" data-path="sec-plot.html"><a href="sec-plot.html"><i class="fa fa-check"></i><b>9</b> Plotting using ggplot</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-plot.html"><a href="sec-plot.html#lo-plot"><i class="fa fa-check"></i><b>9.1</b> Learning outcomes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-maps.html"><a href="sec-maps.html"><i class="fa fa-check"></i><b>10</b> Spartial data and maps</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sec-maps.html"><a href="sec-maps.html#lo-maps"><i class="fa fa-check"></i><b>10.1</b> Learning outcomes</a></li>
</ul></li>
<li class="part"><span><b>V R project in groups</b></span></li>
<li class="chapter" data-level="11" data-path="sec-project.html"><a href="sec-project.html"><i class="fa fa-check"></i><b>11</b> Mandatory R project</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sec-project.html"><a href="sec-project.html#lo-project"><i class="fa fa-check"></i><b>11.1</b> Learning outcomes</a></li>
</ul></li>
<li class="part"><span><b>VI Extra</b></span></li>
<li class="chapter" data-level="12" data-path="sec-r-excel.html"><a href="sec-r-excel.html"><i class="fa fa-check"></i><b>12</b> Using R in Excel and Excel in R</a></li>
<li class="chapter" data-level="13" data-path="sec-opl.html"><a href="sec-opl.html"><i class="fa fa-check"></i><b>13</b> Run an OPL model from R</a></li>
<li class="chapter" data-level="14" data-path="sec-simulation.html"><a href="sec-simulation.html"><i class="fa fa-check"></i><b>14</b> Simulation in R</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#r-project-structure"><i class="fa fa-check"></i>R project structure</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate with your notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a>
<ul>
<li class="chapter" data-level="" data-path="help.html"><a href="help.html#study-café"><i class="fa fa-check"></i>Study café</a>
<ul>
<li class="chapter" data-level="" data-path="help.html"><a href="help.html#need-help---ask-a-question"><i class="fa fa-check"></i>Need help - ask a question</a></li>
<li class="chapter" data-level="" data-path="help.html"><a href="help.html#current-queue"><i class="fa fa-check"></i>Current queue</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="learning-goals.html"><a href="learning-goals.html"><i class="fa fa-check"></i><b>D</b> Learning goals</a></li>
<li class="chapter" data-level="E" data-path="sec-ba.html"><a href="sec-ba.html"><i class="fa fa-check"></i><b>E</b> Business Analytics</a></li>
<li class="chapter" data-level="F" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>F</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-functions" class="section level1" number="5">
<h1><span class="header-section-number">Module 5</span> Functions</h1>
<blockquote>
<p>To understand computations in R, two slogans are helpful:</p>
<p>Everything that exists is an object.</p>
<p>Everything that happens is a function call.</p>
<p>John Chambers</p>
</blockquote>
<p>Writing functions is a core activity of an R programmer. It represents the key step of the transition from a user to a programmer. Functions have inputs and outputs. Functions (and control structures) are what makes your code more dynamic.</p>
<p>Functions are often used to encapsulate a sequence of expressions that need to be executed numerous times, perhaps under slightly different conditions. In programming, functional programming is a programming paradigm, a style how code is written. Rather than repeating code, functions and control structures allow one to build code in blocks. As a result your code becomes more structured, more readable and much easier to maintain and debug (find errors).</p>
<div id="lo-functions" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Learning outcomes</h2>
<p>By the end of this module, you are expected to be able to:</p>
<ul>
<li>Call a function.</li>
<li>Formulate a function with different input arguments.</li>
<li>Describe why functions are important in R.</li>
<li>Set defaults for input arguments.</li>
<li>Return values from functions.</li>
<li>Explain how variable scope and precedence works.</li>
<li>Document functions.</li>
</ul>
<!-- SOLO increasing: identify · memorise · name · do simple procedure · collect data · -->
<!-- enumerate · describe · interpret · formulate · list · paraphrase · combine · do -->
<!-- algorithms · compare · contrast · explain causes · analyse · relate · derive · -->
<!-- evaluate · apply · argue · theorise · generalise · hypothesise · solve · reflect -->
</div>
<div id="datacamp-course" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> DataCamp course</h2>
<p>An excellent introduction to functions is given in <a href="https://campus.datacamp.com/courses/intermediate-r/chapter-3-functions">Chapter 3</a> in the DataCamp course [Intermediate R][datacamp-intermediate-r]. Please complete the chapter before continuing.</p>
</div>
<div id="functions-returning-multiple-objects" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Functions returning multiple objects</h2>
<p>Functions in R only return a single object. However, note that the object may be a list. That is, if you want to return multiple arguments store them in a list. A simple example:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="sec-functions.html#cb57-1" aria-hidden="true"></a>test &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb57-2"><a href="sec-functions.html#cb57-2" aria-hidden="true"></a>  <span class="co"># the function do some stuff and calculate some results</span></span>
<span id="cb57-3"><a href="sec-functions.html#cb57-3" aria-hidden="true"></a>  res1 &lt;-<span class="st"> </span><span class="dv">45</span></span>
<span id="cb57-4"><a href="sec-functions.html#cb57-4" aria-hidden="true"></a>  res2 &lt;-<span class="st"> &quot;Success&quot;</span></span>
<span id="cb57-5"><a href="sec-functions.html#cb57-5" aria-hidden="true"></a>  res3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb57-6"><a href="sec-functions.html#cb57-6" aria-hidden="true"></a>  res4 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">cost =</span> <span class="dv">23</span>, <span class="dt">profit =</span> <span class="dv">200</span>)</span>
<span id="cb57-7"><a href="sec-functions.html#cb57-7" aria-hidden="true"></a>  lst &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">days =</span> res1, <span class="dt">run =</span> res2, <span class="dt">id =</span> res3, <span class="dt">money =</span> res4)</span>
<span id="cb57-8"><a href="sec-functions.html#cb57-8" aria-hidden="true"></a>  <span class="kw">return</span>(lst)</span>
<span id="cb57-9"><a href="sec-functions.html#cb57-9" aria-hidden="true"></a>}</span>
<span id="cb57-10"><a href="sec-functions.html#cb57-10" aria-hidden="true"></a><span class="kw">test</span>()</span>
<span id="cb57-11"><a href="sec-functions.html#cb57-11" aria-hidden="true"></a><span class="co">#&gt; $days</span></span>
<span id="cb57-12"><a href="sec-functions.html#cb57-12" aria-hidden="true"></a><span class="co">#&gt; [1] 45</span></span>
<span id="cb57-13"><a href="sec-functions.html#cb57-13" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb57-14"><a href="sec-functions.html#cb57-14" aria-hidden="true"></a><span class="co">#&gt; $run</span></span>
<span id="cb57-15"><a href="sec-functions.html#cb57-15" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Success&quot;</span></span>
<span id="cb57-16"><a href="sec-functions.html#cb57-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb57-17"><a href="sec-functions.html#cb57-17" aria-hidden="true"></a><span class="co">#&gt; $id</span></span>
<span id="cb57-18"><a href="sec-functions.html#cb57-18" aria-hidden="true"></a><span class="co">#&gt; [1] 4 7 9</span></span>
<span id="cb57-19"><a href="sec-functions.html#cb57-19" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb57-20"><a href="sec-functions.html#cb57-20" aria-hidden="true"></a><span class="co">#&gt; $money</span></span>
<span id="cb57-21"><a href="sec-functions.html#cb57-21" aria-hidden="true"></a><span class="co">#&gt; $money$cost</span></span>
<span id="cb57-22"><a href="sec-functions.html#cb57-22" aria-hidden="true"></a><span class="co">#&gt; [1] 23</span></span>
<span id="cb57-23"><a href="sec-functions.html#cb57-23" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb57-24"><a href="sec-functions.html#cb57-24" aria-hidden="true"></a><span class="co">#&gt; $money$profit</span></span>
<span id="cb57-25"><a href="sec-functions.html#cb57-25" aria-hidden="true"></a><span class="co">#&gt; [1] 200</span></span></code></pre></div>
</div>
<div id="the-...-argument" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> The <code>...</code> argument</h2>
<p>The special argument <code>...</code> which indicate a variable number of arguments and is usually used to pass arguments to nested functions used inside the function. Consider example:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="sec-functions.html#cb58-1" aria-hidden="true"></a>my_name &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">first =</span> <span class="st">&quot;Lars&quot;</span>, <span class="dt">last =</span> <span class="st">&quot;Nielsen&quot;</span>) {</span>
<span id="cb58-2"><a href="sec-functions.html#cb58-2" aria-hidden="true"></a>  <span class="kw">str_c</span>(first, last, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb58-3"><a href="sec-functions.html#cb58-3" aria-hidden="true"></a>}</span>
<span id="cb58-4"><a href="sec-functions.html#cb58-4" aria-hidden="true"></a><span class="kw">my_name</span>()</span>
<span id="cb58-5"><a href="sec-functions.html#cb58-5" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Lars Nielsen&quot;</span></span>
<span id="cb58-6"><a href="sec-functions.html#cb58-6" aria-hidden="true"></a></span>
<span id="cb58-7"><a href="sec-functions.html#cb58-7" aria-hidden="true"></a>cite_text &lt;-<span class="st"> </span><span class="cf">function</span>(text, ...) {</span>
<span id="cb58-8"><a href="sec-functions.html#cb58-8" aria-hidden="true"></a>  <span class="kw">str_c</span>(text, <span class="st">&#39;, -&#39;</span>, <span class="kw">my_name</span>(...))</span>
<span id="cb58-9"><a href="sec-functions.html#cb58-9" aria-hidden="true"></a>}</span>
<span id="cb58-10"><a href="sec-functions.html#cb58-10" aria-hidden="true"></a><span class="kw">cite_text</span>(<span class="st">&quot;Learning by doing is the best way to learn how to program!&quot;</span>)</span>
<span id="cb58-11"><a href="sec-functions.html#cb58-11" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Learning by doing is the best way to learn how to program!, -Lars Nielsen&quot;</span></span>
<span id="cb58-12"><a href="sec-functions.html#cb58-12" aria-hidden="true"></a><span class="kw">cite_text</span>(<span class="st">&quot;Learning by doing is the best way to learn how to program!&quot;</span>, <span class="dt">last =</span> <span class="st">&quot;Relund&quot;</span>)</span>
<span id="cb58-13"><a href="sec-functions.html#cb58-13" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;Learning by doing is the best way to learn how to program!, -Lars Relund&quot;</span></span>
<span id="cb58-14"><a href="sec-functions.html#cb58-14" aria-hidden="true"></a><span class="kw">cite_text</span>(<span class="st">&quot;To be or not to be&quot;</span>, <span class="dt">first =</span> <span class="st">&quot;Shakespeare&quot;</span>, <span class="dt">last =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb58-15"><a href="sec-functions.html#cb58-15" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;To be or not to be, -Shakespeare &quot;</span></span></code></pre></div>
<p>Note in the first function run we use the defaults in <code>my_name</code>. In the second run, we change the default last name and in the last run, we change both arguments.</p>
<p>If you need to retrieve/capture the content of the <code>...</code> argument, put it in a list:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="sec-functions.html#cb59-1" aria-hidden="true"></a>test &lt;-<span class="st"> </span><span class="cf">function</span>(...) {</span>
<span id="cb59-2"><a href="sec-functions.html#cb59-2" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(...))</span>
<span id="cb59-3"><a href="sec-functions.html#cb59-3" aria-hidden="true"></a>}</span>
<span id="cb59-4"><a href="sec-functions.html#cb59-4" aria-hidden="true"></a><span class="kw">test</span>(<span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="st">&quot;hey&quot;</span>, <span class="dt">z =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb59-5"><a href="sec-functions.html#cb59-5" aria-hidden="true"></a><span class="co">#&gt; $x</span></span>
<span id="cb59-6"><a href="sec-functions.html#cb59-6" aria-hidden="true"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb59-7"><a href="sec-functions.html#cb59-7" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb59-8"><a href="sec-functions.html#cb59-8" aria-hidden="true"></a><span class="co">#&gt; $y</span></span>
<span id="cb59-9"><a href="sec-functions.html#cb59-9" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;hey&quot;</span></span>
<span id="cb59-10"><a href="sec-functions.html#cb59-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb59-11"><a href="sec-functions.html#cb59-11" aria-hidden="true"></a><span class="co">#&gt; $z</span></span>
<span id="cb59-12"><a href="sec-functions.html#cb59-12" aria-hidden="true"></a><span class="co">#&gt; [1] 1 2 3 4 5</span></span></code></pre></div>
</div>
<div id="documenting-your-functions" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Documenting your functions</h2>
<p>It is always a good idea to document your functions. This is in fact always done in functions of a package. For instance try <code>?mutate</code> and see the documentation in the <strong>Help</strong> tab.</p>
<p>Assume that you have written a function</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="sec-functions.html#cb60-1" aria-hidden="true"></a>subtract &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb60-2"><a href="sec-functions.html#cb60-2" aria-hidden="true"></a>  <span class="kw">return</span>(x<span class="op">-</span>y)</span>
<span id="cb60-3"><a href="sec-functions.html#cb60-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>In RStudio you can insert a <a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/roxygen2.html">Roxygen</a> documentation skeleton by having the cursor at the first line of the function and go to <strong>Code &gt; Insert Roxygen Skeleton</strong> (Ctrl+Alt+Shift+R):</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="sec-functions.html#cb61-1" aria-hidden="true"></a><span class="co">#&#39; Title</span></span>
<span id="cb61-2"><a href="sec-functions.html#cb61-2" aria-hidden="true"></a><span class="co">#&#39;</span></span>
<span id="cb61-3"><a href="sec-functions.html#cb61-3" aria-hidden="true"></a><span class="co">#&#39; @param x </span></span>
<span id="cb61-4"><a href="sec-functions.html#cb61-4" aria-hidden="true"></a><span class="co">#&#39; @param y </span></span>
<span id="cb61-5"><a href="sec-functions.html#cb61-5" aria-hidden="true"></a><span class="co">#&#39;</span></span>
<span id="cb61-6"><a href="sec-functions.html#cb61-6" aria-hidden="true"></a><span class="co">#&#39; @return</span></span>
<span id="cb61-7"><a href="sec-functions.html#cb61-7" aria-hidden="true"></a><span class="co">#&#39; @export</span></span>
<span id="cb61-8"><a href="sec-functions.html#cb61-8" aria-hidden="true"></a><span class="co">#&#39;</span></span>
<span id="cb61-9"><a href="sec-functions.html#cb61-9" aria-hidden="true"></a><span class="co">#&#39; @examples</span></span>
<span id="cb61-10"><a href="sec-functions.html#cb61-10" aria-hidden="true"></a>subtract &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb61-11"><a href="sec-functions.html#cb61-11" aria-hidden="true"></a>  <span class="kw">return</span>(x<span class="op">-</span>y)</span>
<span id="cb61-12"><a href="sec-functions.html#cb61-12" aria-hidden="true"></a>}</span></code></pre></div>
<p>You now can modify your documentation to</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="sec-functions.html#cb62-1" aria-hidden="true"></a><span class="co">#&#39; Subtract two vectors</span></span>
<span id="cb62-2"><a href="sec-functions.html#cb62-2" aria-hidden="true"></a><span class="co">#&#39;</span></span>
<span id="cb62-3"><a href="sec-functions.html#cb62-3" aria-hidden="true"></a><span class="co">#&#39; @param x First vector.</span></span>
<span id="cb62-4"><a href="sec-functions.html#cb62-4" aria-hidden="true"></a><span class="co">#&#39; @param y Vector to be subtracted.</span></span>
<span id="cb62-5"><a href="sec-functions.html#cb62-5" aria-hidden="true"></a><span class="co">#&#39;</span></span>
<span id="cb62-6"><a href="sec-functions.html#cb62-6" aria-hidden="true"></a><span class="co">#&#39; @return The difference.</span></span>
<span id="cb62-7"><a href="sec-functions.html#cb62-7" aria-hidden="true"></a><span class="co">#&#39; @export</span></span>
<span id="cb62-8"><a href="sec-functions.html#cb62-8" aria-hidden="true"></a><span class="co">#&#39;</span></span>
<span id="cb62-9"><a href="sec-functions.html#cb62-9" aria-hidden="true"></a><span class="co">#&#39; @examples</span></span>
<span id="cb62-10"><a href="sec-functions.html#cb62-10" aria-hidden="true"></a><span class="co">#&#39; subtract(x = c(5,5), y = c(2,3))</span></span>
<span id="cb62-11"><a href="sec-functions.html#cb62-11" aria-hidden="true"></a>subtract &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb62-12"><a href="sec-functions.html#cb62-12" aria-hidden="true"></a>  <span class="kw">return</span>(x<span class="op">-</span>y)</span>
<span id="cb62-13"><a href="sec-functions.html#cb62-13" aria-hidden="true"></a>}</span></code></pre></div>
<p>Note</p>
<ul>
<li>Parameters/function arguments are documented using the <code>@param</code> tag.</li>
<li>Return value is documented using the <code>@return</code> tag.</li>
<li>Under the <code>@examples</code> tag you can insert some examples.</li>
<li>Ignore the <code>@export</code> tag. This is used if you include your function in your own package. Package development is beyond the scope of this course. If you are interested, have a look at the book <span class="citation">Wickham (<a href="#ref-r-pkgs" role="doc-biblioref">2015</a>)</span>.</li>
</ul>
<p>A list of further tags can be seen in the vignette <a href="https://roxygen2.r-lib.org/articles/rd.html">Rd (documentation) tags</a>.</p>
</div>
<div id="lp-functions" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Different learning paths</h2>
<p>We are all different and you may like different learning styles compared to others. As a result you may prefer a different learning path than suggested. Here is a list of possible different learning paths that may be usefull for you.</p>
<ul>
<li>For a more detailed interactive tutorial about functions see the DataCamp course <a href="https://learn.datacamp.com/courses/introduction-to-writing-functions-in-r">Introduction to Writing Functions in R</a>.</li>
<li>Hefin Rhys has a video about <a href="https://www.youtube.com/watch?v=ffPeac3BigM">Writing functions in R</a> giving examples in RStudio.</li>
<li>An introduction to functions is also given in <a href="https://bookdown.org/rdpeng/rprogdatascience/functions.html">Chapter 14</a> of <span class="citation">Peng (<a href="#ref-rdpeng" role="doc-biblioref">2018</a>)</span>.</li>
<li>A detailed tutorial on functions is given in Chapters <a href="https://stat545.com/functions-part1.html">18</a>, <a href="https://stat545.com/functions-part2.html">19</a> and <a href="https://stat545.com/functions-part3.html">20</a> of <span class="citation">Bryan (<a href="#ref-stat545" role="doc-biblioref">2017</a>)</span>.</li>
</ul>
</div>
<div id="rc-functions" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Recap</h2>
<p>Writing functions is a core activity of an R programmer. It represents the key step of the transition from a user to a programmer. Functions have inputs and outputs. Functions (and control structures) are what makes your code more dynamic.</p>
<p>Functions are often used to encapsulate a sequence of expressions that need to be executed numerous times, perhaps under slightly different conditions. In programming, functional programming is a programming paradigm, a style how code is written. Rather than repeating code, functions and control structures allow one to build code in blocks. As a result your code becomes more structured, more readable and much easier to maintain and debug (find errors).</p>
<p>Functions can be defined using the <code>function()</code> directive.</p>
<p>The named arguments (input values) can have default values. Moreover, R passes arguments by value. That is, an R function cannot change the variable that you input to that function.</p>
<p>A function can be called using its name and its arguments can be specified by name or by position in the argument list.</p>
<p>Functions always return the last expression evaluated in the function body or when you use the <code>return</code> flow control statement (good coding practice).</p>
<p>Scoping refers to the rules R uses to lookup the value of variables. A function will first look inside the body of the function to identify all the variables. If all variables exist no further search are required. Otherwise, R will look one level up to see if the variable exists.</p>
<p>Functions can be assigned to R objects just like any other R object.</p>
<p>Document your functions using the Roxygen skeleton!</p>
</div>
<div id="ex-functions" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Exercises</h2>
<p>Below you will find a set of exercises. Always have a look at the exercises before you meet in your study group and try to solve them yourself. Are you stuck see the <a href="help.html#help">help page</a>. Solutions to each exercise can be seen by pressing the button at each question. Beware you will not learn by giving up to early. Put some effort into finding a solution!</p>
<div id="exercise-defining-functions" class="section level3" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Exercise (defining functions)</h3>
<p><em>Solve this exercise using a script file.</em></p>
<div class="modal fade" id="solution0" tabindex="-1" role="dialog" aria-labelledby="solution0-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution0-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">#&#39; Computes the sum of the integers from 1 to n (inclusive).
#&#39;
#&#39; @param n Max value in the sum.
#&#39;
#&#39; @return Sum of the integers from 1 to n.
#&#39;
#&#39; @examples
#&#39; sum_n(30)
sum_n &lt;- function(n) {
  return(sum(1:n))
}
sum_n(5000)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution0">Solution</button>
<ol style="list-style-type: decimal">
<li>Create a function <code>sum_n</code> that for any given value, say <span class="math inline">\(n\)</span>, computes the sum of the integers from 1 to n (inclusive). Use the function to determine the sum of integers from 1 to 5000. Remember to document your function.</li>
</ol>
<div class="modal fade" id="solution1" tabindex="-1" role="dialog" aria-labelledby="solution1-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution1-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">#&#39; Computes the sum S_n = 1^2 + 2^2 + 3^2 + ... + n^2
#&#39;
#&#39; @param n Max input in sum.
#&#39;
#&#39; @return S_n
compute_s_n &lt;- function(n) {
  return(sum((1:n)^2))
}
compute_s_n(10)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution1">Solution</button>
<ol start="2" style="list-style-type: decimal">
<li>Write a function <code>compute_s_n</code> that for any given <span class="math inline">\(n\)</span> computes the sum <span class="math inline">\(S_n = 1^2 + 2^2 + 3^2 + \dots + n^2\)</span>. Report the value of the sum when <span class="math inline">\(n=10\)</span>.</li>
</ol>
<div class="modal fade" id="solution2" tabindex="-1" role="dialog" aria-labelledby="solution2-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution2-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">s_n &lt;- vector(&#39;numeric&#39;, 25)
for (n in 1:25) {
  s_n[n] &lt;- compute_s_n(n)
}
s_n
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution2">Solution</button>
<ol start="3" style="list-style-type: decimal">
<li>Define an empty numerical vector <code>s_n</code> of size 25 using <code>s_n &lt;- vector("numeric", 25)</code> and store in the results of <span class="math inline">\(S_1, S_2, \dots S_{25}\)</span> using a for-loop.
<div class="modal fade" id="solution3" tabindex="-1" role="dialog" aria-labelledby="solution3-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution3-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">compute_s_n_alt &lt;- function(n) {
  return(n*(n+1)*(2*n+1)/6)
}
for (n in 1:25) {
  if (s_n[n] != compute_s_n_alt(n)) {
    cat(&#39;Error!&#39;)
    break
  }
}
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution3">Solution</button>
Confirm that the formula for the sum is <span class="math inline">\(S_n= n(n+1)(2n+1)/6\)</span> for <span class="math inline">\(n = 1, \ldots, 25\)</span>.</li>
</ol>
<div class="modal fade" id="solution4" tabindex="-1" role="dialog" aria-labelledby="solution4-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution4-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">biggest &lt;- function(a, b) {
  if (a &gt; b) return(1)
  return(0)
}
biggest(3,4)
biggest(3,3)
biggest(8,2)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution4">Solution</button>
<ol start="4" style="list-style-type: decimal">
<li>Write a function <code>biggest</code> which takes two integers as arguments. Let the
function return 1 if the first argument is larger than the second and return 0
otherwise.</li>
</ol>
<div class="modal fade" id="solution5" tabindex="-1" role="dialog" aria-labelledby="solution5-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution5-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">shipping_cost &lt;- function(total) {
  return(0.1 * total)
}
shipping_cost(450)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution5">Solution</button>
<ol start="5" style="list-style-type: decimal">
<li>Write a function that returns the shipping cost as 10% of the total cost of an
order (input argument).</li>
</ol>
<div class="modal fade" id="solution6" tabindex="-1" role="dialog" aria-labelledby="solution6-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution6-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">shipping_cost &lt;- function(total, pct = 0.1) {
  return(pct * total)
}
shipping_cost(450)
shipping_cost(450, pct = 0.2)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution6">Solution</button>
<ol start="6" style="list-style-type: decimal">
<li>Given Question 5, rewrite the function so the percentage is an input argument with a default of 10%.</li>
</ol>
<div class="modal fade" id="solution7" tabindex="-1" role="dialog" aria-labelledby="solution7-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution7-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">shipping_cost &lt;- function(total) {
  return(0.1 * total)
}

gasoline_cost &lt;- function(total) {
  return(shipping_cost(total) * 0.5)
}
gasoline_cost(450)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution7">Solution</button>
<ol start="7" style="list-style-type: decimal">
<li>Given Question 5 the shipping cost can be split into parts. One part is gasoline which is 50% of the shipping cost. Write a function that has total cost a input argument and calculate the gasoline cost and uses the function defined in Question 5 inside it.</li>
</ol>
<div class="modal fade" id="solution8" tabindex="-1" role="dialog" aria-labelledby="solution8-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution8-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">shipping_cost &lt;- function(total, pct = 0.1) {
  return(pct * total)
}

gasoline_cost &lt;- function(total, ...) {
  return(shipping_cost(total, ...) * 0.5)
}
gasoline_cost(450)
gasoline_cost(450, pct = 0.2)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution8">Solution</button>
<ol start="8" style="list-style-type: decimal">
<li>Given Question 6 the shipping cost can be split into parts. One part is gasoline which is 50% of the shipping cost. Write a function that has total cost a input argument and calculate the gasoline cost and uses the function defined in Question 6 inside it. Hint: Use the <code>...</code> argument to pass arguments to <code>shipping_cost</code>.</li>
</ol>
<div class="modal fade" id="solution9" tabindex="-1" role="dialog" aria-labelledby="solution9-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution9-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">shipping_cost &lt;- function(total, pct = 0.1) {
  return(pct * total)
}

gasoline_cost &lt;- function(total, ...) {
  return(shipping_cost(total, ...) * 0.5)
}

costs &lt;- function(total, ...) {
  lst &lt;- list(total = total, shipping = shipping_cost(total, ...), gasoline = gasoline_cost(total, ...))
  return(lst)
}
costs(450)
costs(450, pct = 0.15)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution9">Solution</button>
<ol start="9" style="list-style-type: decimal">
<li>Given Question 8, write a function <code>costs</code> that given total cost returns the total cost, shipping cost and gasoline cost.</li>
</ol>
</div>
<div id="exercise-scope" class="section level3" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Exercise (scope)</h3>
<div class="modal fade" id="solution10" tabindex="-1" role="dialog" aria-labelledby="solution10-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution10-title">Solution</h4>
</div>
<div class="modal-body"><p>That value is still 3 since <code>x</code> defined inside the function is a local variable.</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution10">Solution</button>
<ol style="list-style-type: decimal">
<li>After running the code below, what is the value of variable <code>x</code>?</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="sec-functions.html#cb63-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb63-2"><a href="sec-functions.html#cb63-2" aria-hidden="true"></a>my_func &lt;-<span class="st"> </span><span class="cf">function</span>(y){</span>
<span id="cb63-3"><a href="sec-functions.html#cb63-3" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb63-4"><a href="sec-functions.html#cb63-4" aria-hidden="true"></a>  <span class="kw">return</span>(y <span class="op">+</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb63-5"><a href="sec-functions.html#cb63-5" aria-hidden="true"></a>}</span>
<span id="cb63-6"><a href="sec-functions.html#cb63-6" aria-hidden="true"></a><span class="kw">my_func</span>(<span class="dv">7</span>)</span></code></pre></div>
<div class="modal fade" id="solution11" tabindex="-1" role="dialog" aria-labelledby="solution11-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution11-title">Solution</h4>
</div>
<div class="modal-body"><p>The code runs. But it is not good coding practice to call global variables inside a function (<code>x</code>). Instead <code>x</code> should have been an argument to the function.</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution11">Solution</button>
<ol start="2" style="list-style-type: decimal">
<li>Any problems with the following code?</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="sec-functions.html#cb64-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb64-2"><a href="sec-functions.html#cb64-2" aria-hidden="true"></a>my_func &lt;-<span class="st"> </span><span class="cf">function</span>(y){</span>
<span id="cb64-3"><a href="sec-functions.html#cb64-3" aria-hidden="true"></a>  <span class="kw">return</span>(y <span class="op">+</span><span class="st"> </span>x) </span>
<span id="cb64-4"><a href="sec-functions.html#cb64-4" aria-hidden="true"></a>}</span>
<span id="cb64-5"><a href="sec-functions.html#cb64-5" aria-hidden="true"></a><span class="kw">my_func</span>(<span class="dv">7</span>)</span></code></pre></div>
<div class="modal fade" id="solution12" tabindex="-1" role="dialog" aria-labelledby="solution12-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution12-title">Solution</h4>
</div>
<div class="modal-body"><p>That value is still 3 since <code>my_func</code> has not been called yet.</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution12">Solution</button>
<ol start="3" style="list-style-type: decimal">
<li>Have a look at the documentation for operator <code>&lt;&lt;-</code> (run <code>?'&lt;--'</code>). After running the code below, what is the value of variable <code>x</code>?</li>
</ol>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="sec-functions.html#cb65-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb65-2"><a href="sec-functions.html#cb65-2" aria-hidden="true"></a>my_func &lt;-<span class="st"> </span><span class="cf">function</span>(y){</span>
<span id="cb65-3"><a href="sec-functions.html#cb65-3" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb65-4"><a href="sec-functions.html#cb65-4" aria-hidden="true"></a>  x &lt;&lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb65-5"><a href="sec-functions.html#cb65-5" aria-hidden="true"></a>  <span class="kw">return</span>(y <span class="op">+</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb65-6"><a href="sec-functions.html#cb65-6" aria-hidden="true"></a>}</span></code></pre></div>
<div class="modal fade" id="solution13" tabindex="-1" role="dialog" aria-labelledby="solution13-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution13-title">Solution</h4>
</div>
<div class="modal-body"><p>That value of <code>x</code> is 5 since <code>&lt;&lt;-</code> is used to look at the parent environment. The function call returns 11 since the <code>x</code> used is the local variable. In general avoid using <code>&lt;&lt;-</code> and give local variables different names compared to global ones.</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution13">Solution</button>
<ol start="4" style="list-style-type: decimal">
<li>After running the code below, what is the value of variable <code>x</code> and output of the function call?</li>
</ol>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="sec-functions.html#cb66-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb66-2"><a href="sec-functions.html#cb66-2" aria-hidden="true"></a>my_func &lt;-<span class="st"> </span><span class="cf">function</span>(y){</span>
<span id="cb66-3"><a href="sec-functions.html#cb66-3" aria-hidden="true"></a>  x &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb66-4"><a href="sec-functions.html#cb66-4" aria-hidden="true"></a>  x &lt;&lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb66-5"><a href="sec-functions.html#cb66-5" aria-hidden="true"></a>  <span class="kw">return</span>(y <span class="op">+</span><span class="st"> </span>x)</span>
<span id="cb66-6"><a href="sec-functions.html#cb66-6" aria-hidden="true"></a>}</span>
<span id="cb66-7"><a href="sec-functions.html#cb66-7" aria-hidden="true"></a><span class="kw">my_func</span>(<span class="dv">7</span>)</span></code></pre></div>
</div>
<div id="exercise-job-sequencing" class="section level3" number="5.8.3">
<h3><span class="header-section-number">5.8.3</span> Exercise (job sequencing)</h3>
<p><em>Solve this exercise using a script file.</em></p>
<p>This exercise is based on on Exercise 6.12 in <span class="citation">Wøhlk (<a href="#ref-vba-book" role="doc-biblioref">2010</a>)</span>.</p>
<p>Consider a problem of determining the best sequencing of jobs on a machine. A set of startup costs are given for 5 machines:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="sec-functions.html#cb67-1" aria-hidden="true"></a>startup_costs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">32</span>, <span class="dv">35</span>, <span class="dv">26</span>)</span>
<span id="cb67-2"><a href="sec-functions.html#cb67-2" aria-hidden="true"></a>startup_costs</span>
<span id="cb67-3"><a href="sec-functions.html#cb67-3" aria-hidden="true"></a><span class="co">#&gt; [1] 27 28 32 35 26</span></span></code></pre></div>
<p>Moreover, when changing from one job to another job the setup costs are given as:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="sec-functions.html#cb68-1" aria-hidden="true"></a>setup_costs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(</span>
<span id="cb68-2"><a href="sec-functions.html#cb68-2" aria-hidden="true"></a>  <span class="ot">NA</span>, <span class="dv">35</span>, <span class="dv">22</span>, <span class="dv">44</span>, <span class="dv">12</span>,</span>
<span id="cb68-3"><a href="sec-functions.html#cb68-3" aria-hidden="true"></a>  <span class="dv">49</span>, <span class="ot">NA</span>, <span class="dv">46</span>, <span class="dv">38</span>, <span class="dv">17</span>,</span>
<span id="cb68-4"><a href="sec-functions.html#cb68-4" aria-hidden="true"></a>  <span class="dv">46</span>, <span class="dv">12</span>, <span class="ot">NA</span>, <span class="dv">29</span>, <span class="dv">41</span>,</span>
<span id="cb68-5"><a href="sec-functions.html#cb68-5" aria-hidden="true"></a>  <span class="dv">23</span>, <span class="dv">37</span>, <span class="dv">31</span>, <span class="ot">NA</span>, <span class="dv">26</span>,</span>
<span id="cb68-6"><a href="sec-functions.html#cb68-6" aria-hidden="true"></a>  <span class="dv">17</span>, <span class="dv">23</span>, <span class="dv">28</span>, <span class="dv">34</span>, <span class="ot">NA</span>), </span>
<span id="cb68-7"><a href="sec-functions.html#cb68-7" aria-hidden="true"></a>  <span class="dt">byrow =</span> T, <span class="dt">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb68-8"><a href="sec-functions.html#cb68-8" aria-hidden="true"></a>setup_costs</span>
<span id="cb68-9"><a href="sec-functions.html#cb68-9" aria-hidden="true"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb68-10"><a href="sec-functions.html#cb68-10" aria-hidden="true"></a><span class="co">#&gt; [1,]   NA   35   22   44   12</span></span>
<span id="cb68-11"><a href="sec-functions.html#cb68-11" aria-hidden="true"></a><span class="co">#&gt; [2,]   49   NA   46   38   17</span></span>
<span id="cb68-12"><a href="sec-functions.html#cb68-12" aria-hidden="true"></a><span class="co">#&gt; [3,]   46   12   NA   29   41</span></span>
<span id="cb68-13"><a href="sec-functions.html#cb68-13" aria-hidden="true"></a><span class="co">#&gt; [4,]   23   37   31   NA   26</span></span>
<span id="cb68-14"><a href="sec-functions.html#cb68-14" aria-hidden="true"></a><span class="co">#&gt; [5,]   17   23   28   34   NA</span></span></code></pre></div>
<p>The goal of the problem is to determine a sequence of jobs which minimizes the total setup cost including the startup cost.</p>
<p>One possible way to find a sequence is the use a greedy strategy:</p>
<pre><code>Greedy Algorithm
Step 0: Start with the job which has minimal startup cost.
Step 1: Select the next job as the job not already done 
        with minimal setup cost given current job. 
Step 2: Set next job in Step 1 to current job and 
        go to Step 1 if not all jobs are done.</code></pre>
<p>In R the greedy algorithm can be implemented as:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="sec-functions.html#cb70-1" aria-hidden="true"></a>greedy &lt;-<span class="st"> </span><span class="cf">function</span>(startup, setup) {</span>
<span id="cb70-2"><a href="sec-functions.html#cb70-2" aria-hidden="true"></a>  jobs &lt;-<span class="st"> </span><span class="kw">nrow</span>(setup)</span>
<span id="cb70-3"><a href="sec-functions.html#cb70-3" aria-hidden="true"></a>  cur_job &lt;-<span class="st"> </span><span class="kw">which.min</span>(startup)</span>
<span id="cb70-4"><a href="sec-functions.html#cb70-4" aria-hidden="true"></a>  cost &lt;-<span class="st"> </span>startup[cur_job]</span>
<span id="cb70-5"><a href="sec-functions.html#cb70-5" aria-hidden="true"></a>  <span class="kw">cat</span>(<span class="st">&quot;Start job:&quot;</span>, cur_job, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb70-6"><a href="sec-functions.html#cb70-6" aria-hidden="true"></a>  job_seq &lt;-<span class="st"> </span>cur_job</span>
<span id="cb70-7"><a href="sec-functions.html#cb70-7" aria-hidden="true"></a>  setup[, cur_job] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb70-8"><a href="sec-functions.html#cb70-8" aria-hidden="true"></a>  <span class="co"># browser()</span></span>
<span id="cb70-9"><a href="sec-functions.html#cb70-9" aria-hidden="true"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(jobs<span class="dv">-1</span>)) {</span>
<span id="cb70-10"><a href="sec-functions.html#cb70-10" aria-hidden="true"></a>    next_job &lt;-<span class="st"> </span><span class="kw">which.min</span>(setup[cur_job, ])</span>
<span id="cb70-11"><a href="sec-functions.html#cb70-11" aria-hidden="true"></a>    <span class="kw">cat</span>(<span class="st">&quot;Next job:&quot;</span>, next_job, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) </span>
<span id="cb70-12"><a href="sec-functions.html#cb70-12" aria-hidden="true"></a>    cost &lt;-<span class="st"> </span>cost <span class="op">+</span><span class="st"> </span>setup[cur_job, next_job]</span>
<span id="cb70-13"><a href="sec-functions.html#cb70-13" aria-hidden="true"></a>    job_seq &lt;-<span class="st"> </span><span class="kw">c</span>(job_seq, next_job)</span>
<span id="cb70-14"><a href="sec-functions.html#cb70-14" aria-hidden="true"></a>    cur_job &lt;-<span class="st"> </span>next_job</span>
<span id="cb70-15"><a href="sec-functions.html#cb70-15" aria-hidden="true"></a>    setup[, cur_job] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb70-16"><a href="sec-functions.html#cb70-16" aria-hidden="true"></a>  }</span>
<span id="cb70-17"><a href="sec-functions.html#cb70-17" aria-hidden="true"></a>  <span class="co"># print(setup)</span></span>
<span id="cb70-18"><a href="sec-functions.html#cb70-18" aria-hidden="true"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">seq =</span> job_seq, <span class="dt">cost =</span> cost))</span>
<span id="cb70-19"><a href="sec-functions.html#cb70-19" aria-hidden="true"></a>}</span>
<span id="cb70-20"><a href="sec-functions.html#cb70-20" aria-hidden="true"></a><span class="kw">greedy</span>(startup_costs, setup_costs)</span>
<span id="cb70-21"><a href="sec-functions.html#cb70-21" aria-hidden="true"></a><span class="co">#&gt; Start job: 5 </span></span>
<span id="cb70-22"><a href="sec-functions.html#cb70-22" aria-hidden="true"></a><span class="co">#&gt; Next job: 1 </span></span>
<span id="cb70-23"><a href="sec-functions.html#cb70-23" aria-hidden="true"></a><span class="co">#&gt; Next job: 3 </span></span>
<span id="cb70-24"><a href="sec-functions.html#cb70-24" aria-hidden="true"></a><span class="co">#&gt; Next job: 2 </span></span>
<span id="cb70-25"><a href="sec-functions.html#cb70-25" aria-hidden="true"></a><span class="co">#&gt; Next job: 4</span></span>
<span id="cb70-26"><a href="sec-functions.html#cb70-26" aria-hidden="true"></a><span class="co">#&gt; $seq</span></span>
<span id="cb70-27"><a href="sec-functions.html#cb70-27" aria-hidden="true"></a><span class="co">#&gt; [1] 5 1 3 2 4</span></span>
<span id="cb70-28"><a href="sec-functions.html#cb70-28" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb70-29"><a href="sec-functions.html#cb70-29" aria-hidden="true"></a><span class="co">#&gt; $cost</span></span>
<span id="cb70-30"><a href="sec-functions.html#cb70-30" aria-hidden="true"></a><span class="co">#&gt; [1] 115</span></span></code></pre></div>
<p>First, the job with minimum startup cost is found using function <code>which.min</code> and we define cost a the startup cost. We use <code>cat</code> to make some debugging statements and initialize <code>job_seq</code> with the first job. Next we have to have a way ignoring jobs already done. We do that here by setting the columns of setup cost equal to NA for jobs already done. Hence they will not be selected by <code>which.min</code>. The <code>for</code> loop runs 4 times and selects jobs and accumulate the total cost.</p>
<p>A well-known better strategy is to:</p>
<pre><code>Better Algorithm
Step 0: Subtract minimum of startup and setup cost for each job from setup and 
        startup costs (that is columnwise)
Step 1: Call the greedy algorithm with the modified costs. Note that the total 
        cost returned has to be modified a bit.</code></pre>
<div class="modal fade" id="solution14" tabindex="-1" role="dialog" aria-labelledby="solution14-title">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
<h4 class="modal-title" id="solution14-title">Solution</h4>
</div>
<div class="modal-body"><pre><code class="r">better &lt;- function(startup, setup) {
  jobs &lt;- nrow(setup)
  min_col_val &lt;- apply(rbind(startup, setup), 2, min, na.rm = T)
  startup &lt;- startup - min_col_val
  min_mat &lt;- matrix(rep(min_col_val, jobs), 
                    ncol = jobs, byrow = T)
  setup &lt;- setup - min_mat
  lst &lt;- greedy(startup, setup)
  lst$cost &lt;- lst$cost + sum(min_col_val)
  return(lst)
}
better(startup_costs, setup_costs)
</code></pre>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default" style="float:right" data-toggle="modal" data-target="#solution14">Solution</button>
<p>Implement a <code>better</code> function calculating a better strategy. Hint: to find the minimum column costs you may use <code>apply(rbind(startup, setup), 2, min, na.rm = T)</code>.</p>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-stat545">
<p>Bryan, J. 2017. <em>STAT 545 - Data Wrangling, Exploration, and Analysis with R</em>. <a href="https://stat545.com/">https://stat545.com/</a>.</p>
</div>
<div id="ref-rdpeng">
<p>Peng, R. D. 2018. <em>R Programming for Data Science</em>. <a href="https://bookdown.org/rdpeng/rprogdatascience/">https://bookdown.org/rdpeng/rprogdatascience/</a>.</p>
</div>
<div id="ref-r-pkgs">
<p>Wickham, Hadley. 2015. <em>R Packages: Organize, Test, Document, and Share Your Code</em>. O’Reilly Media. <a href="http://r-pkgs.had.co.nz/">http://r-pkgs.had.co.nz/</a>.</p>
</div>
<div id="ref-vba-book">
<p>Wøhlk, S. 2010. <em>VBA Programming in Business Economics</em>. DJØF Publishing.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-loops.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-tidy-intro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bss-osca/tfa/edit/master/book/functions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
